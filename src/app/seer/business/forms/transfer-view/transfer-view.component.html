<seer-loading [isLoading]="isLoading" [type]="'big'"></seer-loading>
<seer-content-top>
  <button class="btn btn-outline-dark" (click)="handleBackBtnClick()">返回</button>
  <ng-container *ngIf="method!='preview'">
  <button class="btn btn-primary" (click)="submitAudit()">提交</button>
  </ng-container>
</seer-content-top>
<seer-progress [type]="'progress'" [contentList]="transferProgres" [currentNode]="currentNode"></seer-progress>
<div class="widgets">
  <div class="row justify-content-center">
    <div class="col-md-12">
      <seer-collapse-card cardTitle="基本信息" cardClass="with-scroll" [canCollapse]=true [defaultExpand]=true>
        <div class="row">
          <form class="form-horizontal" #form1="ngForm">
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="realName" class="col-sm-4 control-label">客户姓名</label>
                <div class="col-sm-8 ">
                  <input class="form-control" id="realName" [(ngModel)]="member.trueName" [ngModelOptions]="{standalone: true}" disabled>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="m_sex" class="col-sm-4 control-label">性别</label>
                <div class="col-sm-8">
                  <select class="form-control" id="m_sex" [(ngModel)]="member.mSex" name="mSex" #mSex="ngModel" disabled
                          dict-select
                          [key]="'M_SEX'"
                          [selected]="member.mSex"
                          [topOption]="{itemid:'',itemName:'请选择'}" >
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label  class="col-sm-4 control-label">年龄</label>
                <div class="col-sm-8">
                  <input class="form-control" [(ngModel)]="member.mAge" name="mAge" #mAge="ngModel" disabled>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="education" class="col-sm-4 control-label">学历</label>
                <div class="col-sm-8">
                  <select class="form-control" id="education" [(ngModel)]="member.education" [ngModelOptions]="{standalone: true}" disabled
                          dict-select
                          [key]="'EDUCATION'"
                          [selected]="member.education"
                          [topOption]="{itemid:'',itemName:'请选择'}">
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="maritaStatus" class="col-sm-4 control-label" >婚姻状况</label>
                <div class="col-sm-8">
                  <select class="form-control" id="maritaStatus" [(ngModel)]="member.maritaStatus" [ngModelOptions]="{standalone: true}" disabled
                          dict-select
                          [key]="'MARRAGE_STATUS'"
                          [selected]="member.maritaStatus"
                          [topOption]="{itemid:'',itemName:'请选择'}">
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="mobilePhone" class="col-sm-4 control-label">手机号</label>
                <div class="col-sm-8">
                  <input class="form-control" id="mobilePhone" [(ngModel)]="member.phoneNumber" [ngModelOptions]="{standalone: true}" disabled>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="idNumber" class="col-sm-4 control-label">身份证号</label>
                <div class="col-sm-8">
                  <input class="form-control" id="idNumber" [(ngModel)]="member.idNumber" [ngModelOptions]="{standalone: true}" disabled>
                </div>
              </div>
            </div>
            <div class="col-sm-12 col-md-12 col-lg-12 col-xlg-12">
              <div class="row">
                <label for="domicilePlace" class="col-sm-4 col-md-2 col-lg-2 col-xlg-1 control-label">户口所在地</label>
                <div class="col-sm-8 col-md-10 col-lg-10 col-xlg-10" id="domicilePlace">
                  <seer-address-picker (notify)="domicilePlaceChanged($event)" [defaultItemCode]="member.domicileDistrict" [defaultAddress]="member.domicileAddress" [disabled]="true">
                  </seer-address-picker>
                </div>
              </div>
            </div>
            <div class="col-sm-12 col-md-12 col-lg-12 col-xlg-12">
              <div class="row">
                <label for="currentResidence" class="col-sm-4 col-md-2 col-lg-2 col-xlg-1 control-label">现居住地</label>
                <div class="col-sm-8 col-md-10 col-lg-10 col-xlg-10" id="currentResidence">
                  <seer-address-picker (notify)="currentResidenceChanged($event)" [defaultItemCode]="member.liveDistrict" [defaultAddress]="member.liveAddress" [disabled]="true">
                  </seer-address-picker>
                </div>
              </div>
            </div>
          </form>
        </div>
      </seer-collapse-card>
      <seer-collapse-card cardTitle="借款信息" cardClass="with-scroll" [canCollapse]=true [defaultExpand]=true>
        <!--借款基本信息-->
        <div class="row">
          <form class="form-horizontal" #form2="ngForm">
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="applyAmt" class="col-sm-4 control-label text-right">借款金额（元）</label>
                <div class="col-sm-8">
                  <input type="number" class="form-control" id="applyAmt" [(ngModel)]="loan.applyAmt" name="applyAmt" #applyAmt="ngModel" disabled>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="loanExpiry" class="col-sm-4 control-label">借款期限</label>
                <div class="col-sm-8 ">
                  <select class="form-control" id="loanExpiry" [(ngModel)]="loan.loanExpiry" name="loanExpiry" #loanExpiry="ngModel" disabled
                          dict-select
                          [key]="'LOAN_APPLY_EXPIRY'"
                          [selected]="loan.loanExpiry"
                          [topOption]="{itemid:'',itemName:'请选择'}">
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="annualRate" class="col-sm-4 control-label">年利率（%）</label>
                <div class="col-sm-8">
                  <input type="number" class="form-control number" id="annualRate" [(ngModel)]="loan.annualRate" name="annualRate" #annualRate="ngModel" disabled>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="raiseRate" class="col-sm-4 control-label">加息（%）</label>
                <div class="col-sm-8 ">
                  <input type="number" class="form-control number" id="raiseRate" [(ngModel)]="loan.raiseRate" name="raiseRate" #raiseRate="ngModel" disabled>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="loanApplyType" class="col-sm-4 control-label">借款类型</label>
                <div class="col-sm-8">
                  <select class="form-control" id="loanApplyType" [(ngModel)]="loan.loanType" (change)="loanTypeChange()" name="loanType" #loanType="ngModel" disabled
                          dict-select
                          [key]="'LOAN_TYPE'"
                          [selected]="loan.loanType"
                          [topOption]="{itemid:'',itemName:'请选择'}">
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="applyNum" class="col-sm-4 control-label">项目编号</label>
                <div class="col-sm-8">
                  <input class="form-control" id="applyNum" [(ngModel)]="loan.projectNum" [ngModelOptions]="{standalone: true}" disabled>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="repayType" class="col-sm-4 control-label">还款方式</label>
                <div class="col-sm-8">
                  <select class="form-control" id="repayType" [(ngModel)]="loan.repayType" name="repayType" #repayType="ngModel" disabled
                          dict-select
                          [key]="'REFUND_WAY'"
                          [selected]="loan.repayType"
                          [topOption]="{itemid:'',itemName:'请选择'}">
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">招标开始日期</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{loan.loanBeginDate | date:'yyyy-MM-dd'}}</label>
                  <!-- <seer-datepicker
                     [dateFormatingRules]="dateFormatingRules || 'yyyy-MM-dd'"
                     [(date)]="loan.loanBeginDate"
                     [disabled]="true"
                   >
                   </seer-datepicker>-->
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label" >招标结束日期</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{loan.loanEndDate | date:'yyyy-MM-dd'}}</label>
                  <!--<seer-datepicker
                    [dateFormatingRules]="dateFormatingRules || 'yyyy-MM-dd'"
                    [(date)]="loan.loanEndDate"
                    [disabled]="true"
                  >
                  </seer-datepicker>-->
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="serviceRate" class="col-sm-4 control-label">手续费（元）</label>
                <div class="col-sm-8">
                  <input class="form-control number" id="serviceRate" [(ngModel)]="loan.serviceRate" name="serviceRate" #serviceRate="ngModel" disabled>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label for="loanPurpose" class="col-sm-4 control-label">借款用途</label>
                <div class="col-sm-8 ">
                  <select class="form-control" id="loanPurpose" [(ngModel)]="loan.loanPurpose" [ngModelOptions]="{standalone: true}" disabled
                          dict-select
                          [key]="'LOAN_PURPOSE'"
                          [selected]="loan.loanPurpose"
                          [topOption]="{itemid:'',itemName:'请选择'}">
                  </select>
                </div>
              </div>
            </div>
          </form>
        </div>
      </seer-collapse-card>
      <seer-collapse-card cardTitle="原始投资记录" cardClass="with-scroll" [canCollapse]=true [defaultExpand]=true>
        <ng-container *ngIf="investRecords.length > 0">
          <seer-simple-table
            [data]="investRecords"
            [titles]="investTitle"
            [hidePagination]="false"
            [hideActions]="true"
            [hideAddButton]="true"
            [showSeq]="true"
          ></seer-simple-table>
        </ng-container>
      </seer-collapse-card>
      <seer-collapse-card cardTitle="项目信息" cardClass="with-scroll" [canCollapse]=true [defaultExpand]=true>
        <div class="row">
          <form class="form-horizontal" >
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">满标审核时间</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{loan.transferDate | date:'yyyy-MM-dd HH:mm:ss'}}</label>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">投资人数</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{loan.investCount || '0'}}人</label>
                </div>
              </div>
            </div>

          </form>
        </div>
      </seer-collapse-card>
      <seer-collapse-card cardTitle="还款记录" cardClass="with-scroll" [canCollapse]=true [defaultExpand]=true>
        <ng-container *ngIf="repayRecords.length > 0">
          <seer-simple-table
            [data]="repayRecords"
            [titles]="repayTitle"
            [hidePagination]="false"
            [hideActions]="true"
            [hideAddButton]="true"
          ></seer-simple-table>
        </ng-container>
        <ng-container *ngIf="repayRecords.length == 0">暂无还款记录</ng-container>
      </seer-collapse-card>
      <seer-collapse-card cardTitle="债权转让信息" cardClass="with-scroll" [canCollapse]=true [defaultExpand]=true>
        <div class="row">
          <form class="form-horizontal" >
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">债权转让人</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{transfer.transferTrueName}}</label>

                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">转让人手机号</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">	{{transfer.transferMobile}}</label>
                </div>
              </div>
            </div>

            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">投资金额</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{transfer.oldInvestAmt}}元</label>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">转让金额</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{transfer.transAmt}}元</label>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">手续费</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{transfer.transFee}}元</label>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">申请时间</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{transfer.applyTime | date:'yyyy-MM-dd HH:mm:ss'}}</label>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">投资人数</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{investTransferRecords.length||'0'}}人</label>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">起投金额</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">
                    {{transfer.minInvestAmount}}
                  </label>
                </div>
              </div>
            </div>
          </form>
        </div>
      </seer-collapse-card>
      <ng-container *ngIf="method!='be_audit'">
      <seer-collapse-card cardTitle="债转投资记录" cardClass="with-scroll" [canCollapse]=true [defaultExpand]=true>
        <ng-container *ngIf="investTransferRecords.length > 0">
          <seer-simple-table
            [data]="investTransferRecords"
            [titles]="investTransferTitle"
            [hidePagination]="false"
            [hideActions]="true"
            [hideAddButton]="true"
            [showSeq]="true"
          ></seer-simple-table>
        </ng-container>
        <ng-container *ngIf="investTransferRecords.length == 0">暂无债转投资记录</ng-container>
      </seer-collapse-card>
      </ng-container>
      <ng-container *ngIf="currentNode==4">
      <seer-collapse-card cardTitle="债转项目信息" cardClass="with-scroll" [canCollapse]=true [defaultExpand]=true>
        <div class="row">
          <form class="form-horizontal" >
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">满标审核时间</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{transfer.transferDate | date:'yyyy-MM-dd HH:mm:ss'}}</label>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-6 col-lg-6 col-xlg-3">
              <div class="row">
                <label class="col-sm-4 control-label">投资人数</label>
                <div class="col-sm-8 ">
                  <label class="form-control" style="background: #f6f6f6">{{investTransferRecords.length || '0'}}人</label>
                </div>
              </div>
            </div>

          </form>
        </div>
      </seer-collapse-card>
      </ng-container>
      <seer-collapse-card cardTitle="审批流程" cardClass="with-scroll" [canCollapse]=true [defaultExpand]=true>
        <ng-container *ngIf="auditProcessRecords.length > 0">
          <seer-simple-table
            [data]="auditProcessRecords"
            [titles]="auditProcessTitle"
            [hidePagination]="true"
            [hideActions]="true"
            [hideAddButton]="true"
            [showSeq]="true"
          ></seer-simple-table>
        </ng-container>
        <ng-container *ngIf="auditProcessRecords.length == 0">暂无审批流程</ng-container>
      </seer-collapse-card>
      <ng-container *ngIf="method!='preview'">
      <seer-collapse-card cardTitle="审批意见" cardClass="with-scroll" [canCollapse]=true [defaultExpand]=true>
        <div class="row">
          <form class="form-horizontal" >
            <div class="form-group col-sm-12 col-md-8 col-lg-6 col-xlg-3">
              <div class="row">
                <label  class="col-sm-4 control-label">审批意见</label>
                <div class="col-sm-8">
                  <div class="radio">
                    <ng-container *ngIf="method!='abortive'">
                    <label class="radio-inline"><input type="radio" name="auditResult" value="pass"   [(ngModel)]="auditResult">通过</label>
                    </ng-container>
                    <label class="radio-inline"><input type="radio" name="auditResult" value="refuse" [(ngModel)]="auditResult">拒绝（流标）</label>
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-8 col-lg-6 col-xlg-3">
              <div class="row">
                <label  class="col-sm-4 control-label">原因(假)</label>
                <div class="col-sm-8">
                  <select *ngIf="auditResult != 'pass'" class="form-control" id="auditReason" [(ngModel)]="auditReason" [ngModelOptions]="{standalone: true}">
                    <option value="">请选择原因</option>
                    <option value="基本信息问题">基本信息问题</option>
                    <option value="其他">其他</option>
                  </select>

                </div>
              </div>
            </div>
            <div class="form-group col-sm-12 col-md-8 col-lg-6 col-xlg-3">
              <div class="row">
                <label  class="col-sm-4 control-label">备注</label>
                <div class="col-sm-8">
                  <textarea class="form-control" id="auditOpinion" [(ngModel)]="auditOpinion" [ngModelOptions]="{standalone: true}" style="overflow: hidden; word-wrap: break-word; resize: horizontal; height: 84px;"></textarea>
                </div>
              </div>
            </div>
          </form>
        </div>
      </seer-collapse-card>
      </ng-container>
    </div>
  </div>
</div>


